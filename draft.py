    #SIGNAL    #---------------------------------------------------------------------------------------------------       column_choose = 'y_mavgs'        total_sum_next_five = df_signals[column_choose].iloc[:5].sum()        if total_sum_next_five > 2:        df_signals.at[0, column_choose] = 0            df_signals['y_combi'] = df_signals['y_target'] + df_signals['y_preds']    df_signals['signal']  = 0            for i in range(len(df_signals)):                if df_signals.loc[i, 'y_combi'] == 0:                        start_idx = max(0, i - 100)            past_signals = df_signals['signal'][start_idx:i]                        last_non_zero = find_first_non_zero(past_signals)                        if df_signals.loc[i, 'y_combi'] == 0 and last_non_zero == -1:                df_signals.loc[i, 'signal'] = 0                            elif df_signals.loc[i, 'y_combi'] == 0 and last_non_zero == 1:                                df_signals.loc[i, 'signal'] = -1                     elif df_signals.loc[i, 'y_combi'] == 2:                        start_idx = max(0, i - 100)            past_signals = df_signals['signal'][start_idx:i]                        last_non_zero = find_first_non_zero(past_signals)                        if df_signals.loc[i, 'y_combi'] == 2 and last_non_zero == -1:                df_signals.loc[i, 'signal'] = 1                            elif df_signals.loc[i, 'y_combi'] == 2 and last_non_zero == 1:                                df_signals.loc[i, 'signal'] = 0                                     elif df_signals.loc[i, 'y_combi'] == 1:                        start_idx = max(0, i - 100)            past_signals = df_signals['signal'][start_idx:i]                        last_non_zero = find_first_non_zero(past_signals)                if df_signals.loc[i, 'y_preds'] == 1 and last_non_zero == -1:               df_signals.loc[i, 'signal']  = 1                            elif df_signals.loc[i, 'y_preds'] == 1 and last_non_zero == 1:                                 df_signals.loc[i, 'signal']  = 0                                 elif df_signals.loc[i, 'y_preds'] == 0 and last_non_zero == 1:                  df_signals.loc[i, 'signal']  = -1                            elif df_signals.loc[i, 'y_preds'] == 0 and last_non_zero == -1:                                 df_signals.loc[i, 'signal']  = 0                            else:                 df_signals.loc[i, 'signal'] = 1